<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="public/css/style.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
</head>
<body>
    <main role="main" class="container">
        <div class="jumbotron">
            <!-- <h1>Luga-t-rap</h1> -->
            <canvas id="myChart" height="200"></canvas>
        </div>
    </main>
<script>
const canvas = document.getElementById('myChart');
const ctx = canvas.getContext('2d');

const stats = {
    "stats": [
        {
            "_type": "artist_stats",
            "_artist_name": "ağaçkakan",
            "_analyzed_word_count": 13311,
            "_unique_word_count": 3612,
            "_top_ten_words": {
                "bir": 314,
                "ben": 200,
                "olmak": 196,
                "bu": 167,
                "yok": 102,
                "etmek": 99,
                "ne": 92,
                "o": 90,
                "iç": 78,
                "sen": 72
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "mode xl",
            "_analyzed_word_count": 15789,
            "_unique_word_count": 2810,
            "_top_ten_words": {
                "sen": 322,
                "olmak": 257,
                "bir": 254,
                "bu": 241,
                "ben": 226,
                "yol": 176,
                "bakmak": 132,
                "vermek": 119,
                "kalmak": 119,
                "göz": 113
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ben fero",
            "_analyzed_word_count": 4488,
            "_unique_word_count": 1118,
            "_top_ten_words": {
                "ben": 132,
                "olmak": 81,
                "demek": 75,
                "bu": 68,
                "sen": 55,
                "yapmak": 52,
                "çok": 51,
                "iş": 49,
                "gibi": 46,
                "için": 44
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ezhel",
            "_analyzed_word_count": 11321,
            "_unique_word_count": 2170,
            "_top_ten_words": {
                "ben": 327,
                "olmak": 221,
                "sen": 181,
                "demek": 156,
                "bu": 131,
                "her": 130,
                "o": 116,
                "ne": 113,
                "bir": 92,
                "yapmak": 91
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "anıl piyancı",
            "_analyzed_word_count": 13285,
            "_unique_word_count": 2353,
            // "_unique_word_count": 2605,
            "_top_ten_words": {
                "ben": 291,
                "bu": 280,
                "olmak": 217,
                "bir": 215,
                "sen": 208,
                "yok": 114,
                "bakmak": 111,
                "demek": 103,
                "değil": 95,
                "her": 94
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "şehinşah",
            "_analyzed_word_count": 28720,
            "_unique_word_count": 5000,
            "_top_ten_words": {
                "ben": 564,
                "olmak": 360,
                "bir": 343,
                "bu": 335,
                "sen": 318,
                "o": 250,
                "ne": 229,
                "rap": 214,
                "etmek": 201,
                "yapmak": 191
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "şanışer",
            "_analyzed_word_count": 28914,
            "_unique_word_count": 3777,
            "_top_ten_words": {
                "ben": 954,
                "olmak": 554,
                "bu": 513,
                "sen": 506,
                "bir": 300,
                "var": 285,
                "yok": 233,
                "gelmek": 219,
                "o": 212,
                "her": 206
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "contra",
            "_analyzed_word_count": 21431,
            "_unique_word_count": 3089,
            "_top_ten_words": {
                "ben": 647,
                "bu": 569,
                "olmak": 356,
                "o": 285,
                "yok": 246,
                "gibi": 241,
                "sen": 236,
                "her": 222,
                "ne": 209,
                "bok": 183
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ceza",
            "_analyzed_word_count": 50527,
            "_unique_word_count": 4862,
            "_top_ten_words": {
                "ben": 1476,
                "bir": 1140,
                "bu": 933,
                "olmak": 924,
                "sen": 703,
                "her": 546,
                "yok": 502,
                "var": 444,
                "gelmek": 432,
                "bakmak": 424
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "sagopa kajmer",
            "_analyzed_word_count": 75818,
            "_unique_word_count": 6565,
            "_top_ten_words": {
                "ben": 1712,
                "bir": 1437,
                "olmak": 1351,
                "bu": 1018,
                "sen": 922,
                "etmek": 503,
                "kendi": 482,
                "o": 480,
                "var": 472,
                "her": 468
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "killa hakan",
            "_analyzed_word_count": 20630,
            "_unique_word_count": 2959,
            "_top_ten_words": {
                "olmak": 382,
                "bir": 378,
                "ben": 303,
                "sen": 302,
                "bakmak": 246,
                "bu": 238,
                "gelmek": 172,
                "demek": 149,
                "yer": 148,
                "göz": 148
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "khontkar",
            "_analyzed_word_count": 14915,
            "_unique_word_count": 2319,
            "_top_ten_words": {
                "ben": 417,
                "sen": 299,
                "bakmak": 230,
                "yok": 221,
                "bu": 218,
                "olmak": 173,
                "o": 159,
                "yine": 119,
                "i": 118,
                "ne": 113
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "norm ender",
            "_analyzed_word_count": 10958,
            "_unique_word_count": 2234,
            "_top_ten_words": {
                "bu": 343,
                "ben": 310,
                "sen": 201,
                "olmak": 186,
                "bir": 175,
                "o": 140,
                "bakmak": 101,
                "yok": 101,
                "demek": 90,
                "ne": 89
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "patron",
            "_analyzed_word_count": 25629,
            "_unique_word_count": 3840,
            "_top_ten_words": {
                "ben": 710,
                "sen": 477,
                "bu": 452,
                "olmak": 373,
                "bir": 262,
                "o": 247,
                "yok": 245,
                "para": 215,
                "her": 195,
                "ne": 188
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "tepki",
            "_analyzed_word_count": 12173,
            "_unique_word_count": 2123,
            "_top_ten_words": {
                "bu": 411,
                "olmak": 211,
                "ben": 192,
                "sen": 150,
                "her": 134,
                "o": 131,
                "ne": 113,
                "benji": 105,
                "daha": 100,
                "yine": 97
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "sokrat st",
            "_analyzed_word_count": 14172,
            "_unique_word_count": 2159,
            "_top_ten_words": {
                "ben": 485,
                "bu": 300,
                "olmak": 285,
                "sen": 275,
                "bir": 207,
                "değil": 154,
                "yok": 136,
                "ne": 134,
                "hayat": 124,
                "her": 122
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "kamufle",
            "_analyzed_word_count": 8399,
            "_unique_word_count": 1921,
            "_top_ten_words": {
                "ben": 226,
                "olmak": 175,
                "bu": 158,
                "bir": 124,
                "sen": 100,
                "ne": 81,
                "etmek": 79,
                "yok": 78,
                "var": 76,
                "her": 69
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "no.1",
            "_analyzed_word_count": 39726,
            "_unique_word_count": 4172,
            "_top_ten_words": {
                "ben": 1214,
                "bu": 794,
                "sen": 730,
                "olmak": 722,
                "bir": 420,
                "yok": 348,
                "gelmek": 304,
                "gibi": 296,
                "bakmak": 276,
                "her": 264
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "server uraz,pit10",
            "_analyzed_word_count": 30931,
            "_unique_word_count": 4257,
            "_top_ten_words": {
                "ben": 868,
                "bu": 601,
                "bir": 514,
                "olmak": 506,
                "sen": 412,
                "o": 292,
                "yok": 260,
                "her": 231,
                "var": 220,
                "kalmak": 218
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "xir,xir gökdeniz",
            "_analyzed_word_count": 13343,
            "_unique_word_count": 2315,
            "_top_ten_words": {
                "ben": 459,
                "bu": 349,
                "olmak": 309,
                "sen": 298,
                "bir": 177,
                "ne": 147,
                "o": 140,
                "yok": 130,
                "her": 119,
                "gelmek": 111
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "grogi",
            "_analyzed_word_count": 7081,
            "_unique_word_count": 1804,
            "_top_ten_words": {
                "bu": 135,
                "ben": 130,
                "olmak": 124,
                "yok": 92,
                "o": 88,
                "sen": 77,
                "bir": 70,
                "gün": 69,
                "her": 64,
                "kafa": 64
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ceg,cegıd",
            "_analyzed_word_count": 22601,
            "_unique_word_count": 3614,
            "_top_ten_words": {
                "ben": 1015,
                "bu": 848,
                "olmak": 327,
                "o": 323,
                "değil": 234,
                "vermek": 217,
                "gibi": 199,
                "etmek": 172,
                "her": 169,
                "sen": 166
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "saian",
            "_analyzed_word_count": 14957,
            "_unique_word_count": 3620,
            "_top_ten_words": {
                "ben": 400,
                "bir": 342,
                "sen": 296,
                "bu": 155,
                "olmak": 145,
                "gelmek": 112,
                "biz": 103,
                "var": 100,
                "bakmak": 99,
                "her": 95
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "aga b",
            "_analyzed_word_count": 4899,
            "_unique_word_count": 1455,
            "_top_ten_words": {
                "bu": 147,
                "ne": 93,
                "biz": 61,
                "yok": 54,
                "bir": 51,
                "ben": 51,
                "sen": 49,
                "o": 48,
                "olmak": 46,
                "daha": 46
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "şam,şam (tur)",
            "_analyzed_word_count": 2144,
            "_unique_word_count": 704,
            "_top_ten_words": {
                "bu": 92,
                "bir": 50,
                "ben": 48,
                "olmak": 46,
                "sen": 27,
                "bakmak": 26,
                "yok": 23,
                "yol": 23,
                "yaşamak": 21,
                "hayat": 19
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "fuat",
            "_analyzed_word_count": 8440,
            "_unique_word_count": 2761,
            "_top_ten_words": {
                "olmak": 126,
                "gibi": 99,
                "hepsi": 94,
                "ben": 80,
                "gelmek": 78,
                "sen": 73,
                "yok": 67,
                "bir": 67,
                "fuat": 64,
                "el": 64
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ayben",
            "_analyzed_word_count": 10374,
            "_unique_word_count": 1937,
            "_top_ten_words": {
                "ben": 275,
                "olmak": 173,
                "bu": 165,
                "var": 160,
                "sen": 160,
                "rap": 148,
                "bir": 143,
                "o": 129,
                "gelmek": 128,
                "her": 118
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "hidra",
            "_analyzed_word_count": 33531,
            "_unique_word_count": 4567,
            "_top_ten_words": {
                "ben": 826,
                "bu": 800,
                "bir": 447,
                "olmak": 442,
                "o": 338,
                "yok": 325,
                "var": 305,
                "sen": 303,
                "demek": 263,
                "gibi": 254
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "joker,joker (türkiye)",
            "_analyzed_word_count": 25595,
            "_unique_word_count": 3681,
            "_top_ten_words": {
                "ben": 628,
                "bu": 626,
                "olmak": 359,
                "sen": 321,
                "bir": 273,
                "etmek": 240,
                "yapmak": 234,
                "demek": 190,
                "ne": 185,
                "değil": 178
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "allame",
            "_analyzed_word_count": 27679,
            "_unique_word_count": 4666,
            "_top_ten_words": {
                "bu": 606,
                "ben": 572,
                "olmak": 472,
                "sen": 439,
                "bir": 367,
                "o": 226,
                "yok": 220,
                "etmek": 202,
                "vermek": 196,
                "var": 182
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "sansar salvo",
            "_analyzed_word_count": 32654,
            "_unique_word_count": 4074,
            "_top_ten_words": {
                "bu": 729,
                "ben": 685,
                "olmak": 648,
                "bir": 381,
                "sen": 350,
                "her": 283,
                "bakmak": 274,
                "o": 261,
                "var": 247,
                "yok": 222
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "keişan",
            "_analyzed_word_count": 5310,
            "_unique_word_count": 1435,
            "_top_ten_words": {
                "ben": 145,
                "bu": 118,
                "sen": 74,
                "olmak": 72,
                "gucci": 61,
                "demek": 53,
                "hep": 52,
                "gibi": 47,
                "var": 45,
                "istemek": 45
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "hayki",
            "_analyzed_word_count": 24285,
            "_unique_word_count": 3440,
            "_top_ten_words": {
                "ben": 810,
                "sen": 525,
                "bu": 524,
                "bir": 373,
                "olmak": 352,
                "ne": 227,
                "yok": 225,
                "o": 214,
                "her": 169,
                "bakmak": 163
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "dr. fuchs",
            "_analyzed_word_count": 13397,
            "_unique_word_count": 1950,
            "_top_ten_words": {
                "ben": 373,
                "bu": 272,
                "sen": 270,
                "olmak": 225,
                "bir": 212,
                "her": 158,
                "bilmek": 145,
                "basmak": 132,
                "gün": 126,
                "o": 118
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "yener çevik",
            "_analyzed_word_count": 9320,
            "_unique_word_count": 2195,
            "_top_ten_words": {
                "ben": 172,
                "sen": 150,
                "olmak": 135,
                "bu": 110,
                "bir": 81,
                "demek": 77,
                "var": 73,
                "gitmek": 70,
                "gelmek": 67,
                "yol": 64
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "farazi v kayra",
            "_analyzed_word_count": 10355,
            "_unique_word_count": 2057,
            "_top_ten_words": {
                "bir": 361,
                "ben": 249,
                "bu": 206,
                "olmak": 156,
                "sen": 135,
                "o": 110,
                "gelmek": 103,
                "var": 99,
                "bakmak": 84,
                "yok": 79
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "da poet",
            "_analyzed_word_count": 7877,
            "_unique_word_count": 2075,
            "_top_ten_words": {
                "ben": 177,
                "bu": 112,
                "olmak": 102,
                "sen": 94,
                "bir": 93,
                "yine": 71,
                "yok": 69,
                "var": 67,
                "vermek": 67,
                "rap": 61
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "karaçalı",
            "_analyzed_word_count": 11048,
            "_unique_word_count": 3250,
            "_top_ten_words": {
                "bir": 232,
                "ben": 198,
                "olmak": 138,
                "sen": 124,
                "bu": 116,
                "o": 89,
                "yok": 60,
                "her": 58,
                "etmek": 56,
                "vermek": 56
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ados",
            "_analyzed_word_count": 19417,
            "_unique_word_count": 2983,
            "_top_ten_words": {
                "ben": 492,
                "bir": 456,
                "bu": 393,
                "olmak": 346,
                "sen": 257,
                "yok": 207,
                "o": 198,
                "ne": 171,
                "insan": 161,
                "var": 157
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ethnique punch",
            "_analyzed_word_count": 3985,
            "_unique_word_count": 1979,
            "_top_ten_words": {
                "olmak": 65,
                "bu": 63,
                "bir": 55,
                "ben": 35,
                "ne": 24,
                "kalmak": 24,
                "iç": 20,
                "zaman": 18,
                "o": 18,
                "her": 18
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "eypio",
            "_analyzed_word_count": 5928,
            "_unique_word_count": 1600,
            "_top_ten_words": {
                "ben": 168,
                "bu": 123,
                "biz": 93,
                "var": 92,
                "olmak": 82,
                "sen": 81,
                "yok": 69,
                "demek": 60,
                "gelmek": 59,
                "bir": 52
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "ati242",
            "_analyzed_word_count": 8692,
            "_unique_word_count": 1869,
            "_top_ten_words": {
                "bu": 173,
                "kafa": 140,
                "ben": 139,
                "sen": 135,
                "ey": 121,
                "o": 105,
                "yok": 92,
                "ah": 90,
                "olmak": 89,
                "bakmak": 78
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "beta",
            "_analyzed_word_count": 14825,
            "_unique_word_count": 2660,
            "_top_ten_words": {
                "ben": 713,
                "sen": 481,
                "olmak": 343,
                "bu": 252,
                "bir": 180,
                "o": 159,
                "yok": 157,
                "yapmak": 146,
                "var": 130,
                "çok": 119
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "heja",
            "_analyzed_word_count": 419,
            "_unique_word_count": 183,
            "_top_ten_words": {
                "biri": 21,
                "iç": 21,
                "bugün": 18,
                "ben": 15,
                "kan": 15,
                "toz": 13,
                "ter": 12,
                "var": 11,
                "bakmak": 10,
                "kurşun": 8
            }
        },
        {
            "_type": "artist_stats",
            "_artist_name": "gazapizm",
            "_analyzed_word_count": 15762,
            "_unique_word_count": 2726,
            "_top_ten_words": {
                "bir": 472,
                "ben": 337,
                "olmak": 299,
                "bu": 293,
                "sen": 180,
                "yok": 175,
                "bakmak": 153,
                "yol": 141,
                "kalmak": 134,
                "o": 126
            }
        },
    ],
};

const images = [];
const datasets = [];
const y = {};


stats.stats.forEach((element, index) => {
    let image = new Image(80, 80);
    image.src = `public/images/${element._artist_name}.png`;
    images.push(image);

    let yValue = 10;
    let xValue = element._unique_word_count;
    let yCounter = 1;

    while (true) {
        let flag = true;
        if (!(yValue in y)) {
            y[yValue] = []
        }
        y[yValue].forEach((value) => {
            if (Math.abs(value - xValue) < 430) {
                if (yCounter % 2 === 1) {
                    yValue += (5 * yCounter)
                } else {
                    yValue -= (5 * yCounter);
                }
                flag = false;
                yCounter++;
            }
        });
        if (flag) break;
    }
    y[yValue].push(xValue);
    let d = {
        label: element._artist_name,
        data: [{x: xValue, y:yValue, r:30}]
    };
    datasets.push(d)
});

Chart.plugins.register({
    afterUpdate: function(chart) {
        images.forEach((element, index) => {
            chart.config.data.datasets[index]._meta[0].data[0]._model.pointStyle = element;
        });
    }
});

const customTooltips = function(tooltip) {
    let tooltipEl = document.getElementById('chartjs-tooltip');

    if (!tooltipEl) {
        tooltipEl = document.createElement('div');
        tooltipEl.id = 'chartjs-tooltip';
        tooltipEl.innerHTML = '<table></table>';
        this._chart.canvas.parentNode.appendChild(tooltipEl);
    }

    if (tooltip.opacity === 0) {
        tooltipEl.style.opacity = '0';
        return;
    }

    // Set caret Position
    tooltipEl.classList.remove('above', 'below', 'no-transform');
    if (tooltip.yAlign) {
        tooltipEl.classList.add(tooltip.yAlign);
    } else {
        tooltipEl.classList.add('no-transform');
    }

    function getBody(bodyItem) {
        return bodyItem.lines;
    }

    // Set Text
    if (tooltip.body) {
        let titleLines = tooltip.title || [];
        let bodyLines = tooltip.body.map(getBody);

        let innerHtml = '<thead>';

        titleLines.forEach(function(title) {
            innerHtml += '<tr><th>' + title + '</th></tr>';
        });
        innerHtml += '</thead><tbody>';

        bodyLines.forEach(function(body, i) {
            let colors = tooltip.labelColors[i];
            let style = 'background:' + colors.backgroundColor;
            style += '; border-color:' + colors.borderColor;
            style += '; border-width: 2px';
            let span = '<span class="chartjs-tooltip-key" style="' + style + '"></span>';
            innerHtml += '<tr><td>' + span + body + '</td></tr>';
        });
        innerHtml += '</tbody>';

        let tableRoot = tooltipEl.querySelector('table');
        tableRoot.innerHTML = innerHtml;
    }

    let positionY = this._chart.canvas.offsetTop;
    let positionX = this._chart.canvas.offsetLeft;

    // Display, position, and set styles for font
    tooltipEl.style.opacity = 1;
    tooltipEl.style.left = positionX + tooltip.caretX + 'px';
    tooltipEl.style.top = positionY + tooltip.caretY + 'px';
    tooltipEl.style.fontFamily = tooltip._bodyFontFamily;
    tooltipEl.style.fontSize = tooltip.bodyFontSize + 'px';
    tooltipEl.style.fontStyle = tooltip._bodyFontStyle;
    tooltipEl.style.padding = tooltip.yPadding + 'px ' + tooltip.xPadding + 'px';
};

const lugatrapChart = new Chart(ctx, {
    type: 'bubble',
    data: {
        datasets: datasets
    },
    options: {
        scales: {
            yAxes: [{
                display: false
            }],
            xAxes: [{
                ticks: {
                    suggestedMin: 0,
                    suggestedMax: 7000
                }
            }]
        },
        tooltips: {
            callbacks: {
                label: function(tooltipItem, data) {
                    let x = data.datasets[tooltipItem.datasetIndex];
                    console.log(x);
                    let label = data.datasets[tooltipItem.datasetIndex].label || '';
                    if (label) {
                        label += ': ';
                    }
                    label += tooltipItem.xLabel;
                    return label
                }
            },
            enabled: false,
            mode: 'dataset',
            position: 'nearest',
            custom: customTooltips
        }
    }
});
</script>
</body>
</html>